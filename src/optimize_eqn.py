import numpy as np
import gurobipy
import gurobi_utils as grb_utils
from numpy import sign
from numpy import abs

def opt_equations(A,B,C,D, case):
    derivative = np.zeros((12))

    if case==1:
        derivative[0] = - ((B[1] - D[1])*(C[2] - D[2]) - (B[2] - D[2])*(C[1] - D[1]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) - ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(C[1] - D[1]) + 2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(C[2] - D[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[1] = ((B[0] - D[0])*(C[2] - D[2]) - (B[2] - D[2])*(C[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) + ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(C[0] - D[0]) - 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(C[2] - D[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[2] = ((2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(C[0] - D[0]) + 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(C[1] - D[1]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2)) - ((B[0] - D[0])*(C[1] - D[1]) - (B[1] - D[1])*(C[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2)
        derivative[3] = ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]) + (B[1] - D[1])*(C[2] - D[2]) - (B[2] - D[2])*(C[1] - D[1]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) + ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(C[1] - D[1]) + 2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(C[2] - D[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[4] = - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]) + (B[0] - D[0])*(C[2] - D[2]) - (B[2] - D[2])*(C[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) - ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(C[0] - D[0]) - 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(C[2] - D[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[5] = ((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]) + (B[0] - D[0])*(C[1] - D[1]) - (B[1] - D[1])*(C[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) - ((2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(C[0] - D[0]) + 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(C[1] - D[1]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[6] = ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(A[1] - B[1]) + 2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(A[2] - B[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2)) - ((A[1] - B[1])*(B[2] - D[2]) - (A[2] - B[2])*(B[1] - D[1]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2)
        derivative[7] = ((A[0] - B[0])*(B[2] - D[2]) - (A[2] - B[2])*(B[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) - ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(A[0] - B[0]) - 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(A[2] - B[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[8] = - ((A[0] - B[0])*(B[1] - D[1]) - (A[1] - B[1])*(B[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) - ((2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(A[0] - B[0]) + 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(A[1] - B[1]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[9] = ((A[1] - B[1])*(B[2] - D[2]) - (A[2] - B[2])*(B[1] - D[1]) - (A[1] - B[1])*(C[2] - D[2]) + (A[2] - B[2])*(C[1] - D[1]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) - ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(A[1] - B[1]) + 2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(A[2] - B[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))
        derivative[10] = ((2*abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(A[0] - B[0]) - 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(A[2] - B[2]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2)) - ((A[0] - B[0])*(B[2] - D[2]) - (A[2] - B[2])*(B[0] - D[0]) - (A[0] - B[0])*(C[2] - D[2]) + (A[2] - B[2])*(C[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2)
        derivative[11] = ((A[0] - B[0])*(B[1] - D[1]) - (A[1] - B[1])*(B[0] - D[0]) - (A[0] - B[0])*(C[1] - D[1]) + (A[1] - B[1])*(C[0] - D[0]))/(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(1/2) + ((2*abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*sign((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(A[0] - B[0]) + 2*abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*sign((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(A[1] - B[1]))*(((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))*(B[2] - D[2]) - ((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))*(B[1] - D[1]) + ((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))*(B[0] - D[0])))/(2*(abs((A[0] - B[0])*(C[1] - D[1]) - (A[1] - B[1])*(C[0] - D[0]))**2 + abs((A[0] - B[0])*(C[2] - D[2]) - (A[2] - B[2])*(C[0] - D[0]))**2 + abs((A[1] - B[1])*(C[2] - D[2]) - (A[2] - B[2])*(C[1] - D[1]))**2)**(3/2))

    elif case==2:
        derivative[0] = 0
        derivative[1] = 0
        derivative[2] = 0
        derivative[3] = (2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*((C[0] - D[0])**2/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - 1) + (2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + (2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[4] = (2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*((C[1] - D[1])**2/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - 1) + (2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + (2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[1] - D[1])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[5] = (2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*((C[2] - D[2])**2/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - 1) + (2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + (2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[1] - D[1])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[6] = (2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[0] - 2*D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[0] - 2*D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((B[0] - D[0])*(C[0] - D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[0] - 2*D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[7] = (2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[1] - D[1])*(C[0] - D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[1] - 2*D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[1] - D[1])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[1] - 2*D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((B[1] - D[1])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[1] - 2*D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[8] = (2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[2] - D[2])*(C[0] - D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[2] - 2*D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[2] - D[2])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[2] - 2*D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[2] - 2*D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[9] = -(2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((C[0] - D[0])*(B[0] + C[0] - 2*D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[0] - 2*D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2 - 1) + 2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[1] - D[1])*(B[0] + C[0] - 2*D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[0] - 2*D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[2] - D[2])*(B[0] + C[0] - 2*D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[0] - 2*D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[10] = -(2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((C[1] - D[1])*(B[1] + C[1] - 2*D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[1] - 2*D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2 - 1) + 2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[0] - D[0])*(B[1] + C[1] - 2*D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[1] - 2*D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[2] - D[2])*(B[1] + C[1] - 2*D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[1] - 2*D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[11] = -(2*abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((C[2] - D[2])*(B[2] + C[2] - 2*D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[2] - 2*D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2 - 1) + 2*abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[0] - D[0])*(B[2] + C[2] - 2*D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[2] - 2*D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[1] - D[1])*(B[2] + C[2] - 2*D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[2] - 2*D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - B[0] + ((C[0] - D[0])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - B[1] + ((C[1] - D[1])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - B[2] + ((C[2] - D[2])*((B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))

    elif case==3:
        derivative[0] = (2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*((C[0] - D[0])**2/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - 1) + (2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + (2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[1] = (2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*((C[1] - D[1])**2/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - 1) + (2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + (2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[1] - D[1])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[2] = (2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*((C[2] - D[2])**2/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - 1) + (2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[0] - D[0])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + (2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(C[1] - D[1])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[3] = 0
        derivative[4] = 0
        derivative[5] = 0
        derivative[6] = (2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((A[0] - D[0])*(C[0] - D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[0] - 2*D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - D[0])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[0] - 2*D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - D[0])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[0] - 2*D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[7] = (2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((A[1] - D[1])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[1] - 2*D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[1] - D[1])*(C[0] - D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[1] - 2*D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[1] - D[1])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[1] - 2*D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[8] = (2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((A[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[2] - 2*D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[2] - D[2])*(C[0] - D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[2] - 2*D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[2] - D[2])*(C[1] - D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[2] - 2*D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[9] = -(2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[1] - D[1])*(A[0] + C[0] - 2*D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[0] - 2*D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[2] - D[2])*(A[0] + C[0] - 2*D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[0] - 2*D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((C[0] - D[0])*(A[0] + C[0] - 2*D[0]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[0] - 2*D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2 - 1))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[10] = -(2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[0] - D[0])*(A[1] + C[1] - 2*D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[1] - 2*D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[2] - D[2])*(A[1] + C[1] - 2*D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[1] - 2*D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((C[1] - D[1])*(A[1] + C[1] - 2*D[1]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[1] - 2*D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2 - 1))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))
        derivative[11] = -(2*abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[0] - D[0])*(A[2] + C[2] - 2*D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[0] - D[0])*(2*C[2] - 2*D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((C[1] - D[1])*(A[2] + C[2] - 2*D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[1] - D[1])*(2*C[2] - 2*D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2) + 2*abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*sign(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))*(((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) + ((C[2] - D[2])*(A[2] + C[2] - 2*D[2]))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2) - ((C[2] - D[2])*(2*C[2] - 2*D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2)**2 - 1))/(2*(abs(D[0] - A[0] + ((C[0] - D[0])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[1] - A[1] + ((C[1] - D[1])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2 + abs(D[2] - A[2] + ((C[2] - D[2])*((A[0] - B[0])*(C[0] - D[0]) + (A[1] - B[1])*(C[1] - D[1]) + (A[2] - B[2])*(C[2] - D[2]) + (B[0] - D[0])*(C[0] - D[0]) + (B[1] - D[1])*(C[1] - D[1]) + (B[2] - D[2])*(C[2] - D[2])))/((C[0] - D[0])**2 + (C[1] - D[1])**2 + (C[2] - D[2])**2))**2)**(1/2))

    elif case==4:
        derivative[0] = (2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(B[0] - D[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(B[0] - D[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[0] - B[0])*(B[0] - D[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[1] = (2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[1] - D[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(B[1] - D[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[1] - B[1])*(B[1] - D[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[2] = (2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[3] = (2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(A[0] - 2*B[0] + D[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[1] - B[1])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(A[0] - 2*B[0] + D[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[2] - B[2])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) - 2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(A[0] - 2*B[0] + D[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2 + 1))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[4] = (2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(A[1] - 2*B[1] + D[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[0] - B[0])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(A[1] - 2*B[1] + D[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[2] - B[2])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) - 2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(A[1] - 2*B[1] + D[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2 + 1))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[5] = (2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(A[2] - 2*B[2] + D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[0] - B[0])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(A[2] - 2*B[2] + D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[1] - B[1])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) - 2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(A[2] - 2*B[2] + D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2 + 1))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[6] = 0
        derivative[7] = 0
        derivative[8] = 0
        derivative[9] = -(2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*((A[0] - B[0])**2/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - 1) + (2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[1] - B[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + (2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[10] = -(2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*((A[1] - B[1])**2/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - 1) + (2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[1] - B[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + (2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[1] - B[1])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[11] = -(2*sign(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*((A[2] - B[2])**2/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - 1) + (2*sign(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + (2*sign(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[1] - B[1])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))/(2*(abs(D[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(D[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))

    elif case==5:
        derivative[0] = 0
        derivative[1] = 0
        derivative[2] = 0
        derivative[3] = (abs(B[0] - D[0])*sign(B[0] - D[0]))/(abs(B[0] - D[0])**2 + abs(B[1] - D[1])**2 + abs(B[2] - D[2])**2)**(1/2)
        derivative[4] = (abs(B[1] - D[1])*sign(B[1] - D[1]))/(abs(B[0] - D[0])**2 + abs(B[1] - D[1])**2 + abs(B[2] - D[2])**2)**(1/2)
        derivative[5] = (abs(B[2] - D[2])*sign(B[2] - D[2]))/(abs(B[0] - D[0])**2 + abs(B[1] - D[1])**2 + abs(B[2] - D[2])**2)**(1/2)
        derivative[6] = 0
        derivative[7] = 0
        derivative[8] = 0
        derivative[9] = -(abs(B[0] - D[0])*sign(B[0] - D[0]))/(abs(B[0] - D[0])**2 + abs(B[1] - D[1])**2 + abs(B[2] - D[2])**2)**(1/2)
        derivative[10] = -(abs(B[1] - D[1])*sign(B[1] - D[1]))/(abs(B[0] - D[0])**2 + abs(B[1] - D[1])**2 + abs(B[2] - D[2])**2)**(1/2)
        derivative[11] = -(abs(B[2] - D[2])*sign(B[2] - D[2]))/(abs(B[0] - D[0])**2 + abs(B[1] - D[1])**2 + abs(B[2] - D[2])**2)**(1/2)

    elif case==6:
        derivative[0] = (abs(A[0] - D[0])*sign(A[0] - D[0]))/(abs(A[0] - D[0])**2 + abs(A[1] - D[1])**2 + abs(A[2] - D[2])**2)**(1/2)
        derivative[1] = (abs(A[1] - D[1])*sign(A[1] - D[1]))/(abs(A[0] - D[0])**2 + abs(A[1] - D[1])**2 + abs(A[2] - D[2])**2)**(1/2)
        derivative[2] = (abs(A[2] - D[2])*sign(A[2] - D[2]))/(abs(A[0] - D[0])**2 + abs(A[1] - D[1])**2 + abs(A[2] - D[2])**2)**(1/2)
        derivative[3] = 0
        derivative[4] = 0
        derivative[5] = 0
        derivative[6] = 0
        derivative[7] = 0
        derivative[8] = 0
        derivative[9] = -(abs(A[0] - D[0])*sign(A[0] - D[0]))/(abs(A[0] - D[0])**2 + abs(A[1] - D[1])**2 + abs(A[2] - D[2])**2)**(1/2)
        derivative[10] = -(abs(A[1] - D[1])*sign(A[1] - D[1]))/(abs(A[0] - D[0])**2 + abs(A[1] - D[1])**2 + abs(A[2] - D[2])**2)**(1/2)
        derivative[11] = -(abs(A[2] - D[2])*sign(A[2] - D[2]))/(abs(A[0] - D[0])**2 + abs(A[1] - D[1])**2 + abs(A[2] - D[2])**2)**(1/2)

    elif case==7:
        derivative[0] = (2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[0] - B[0])*(B[0] - C[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(B[0] - C[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(B[0] - C[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[1] = (2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[1] - B[1])*(B[1] - C[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[1] - C[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(B[1] - C[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[2] = (2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[2] - B[2])*(B[2] - C[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[2] - C[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) + 2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(B[2] - C[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[3] = (2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(A[0] - 2*B[0] + C[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[1] - B[1])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) - 2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(A[0] - 2*B[0] + C[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[0] - B[0])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2 + 1) + 2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(A[0] - 2*B[0] + C[0]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[2] - B[2])*(2*A[0] - 2*B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[4] = (2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(A[1] - 2*B[1] + C[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[0] - B[0])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) - 2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(A[1] - 2*B[1] + C[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[1] - B[1])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2 + 1) + 2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[2] - B[2])*(A[1] - 2*B[1] + C[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[2] - B[2])*(2*A[1] - 2*B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[5] = (2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(A[2] - 2*B[2] + C[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[0] - B[0])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2) - 2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(A[2] - 2*B[2] + C[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - ((A[2] - B[2])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2 + 1) + 2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(((A[1] - B[1])*(A[2] - 2*B[2] + C[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + ((A[1] - B[1])*(2*A[2] - 2*B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2)**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[6] = -(2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*((A[0] - B[0])**2/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - 1) + (2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[1] - B[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + (2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[7] = -(2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*((A[1] - B[1])**2/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - 1) + (2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[1] - B[1]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + (2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[1] - B[1])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[8] = -(2*abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*((A[2] - B[2])**2/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) - 1) + (2*abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[0] - B[0])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2) + (2*abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*sign(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))*(A[1] - B[1])*(A[2] - B[2]))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))/(2*(abs(C[0] - B[0] + ((A[0] - B[0])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[1] - B[1] + ((A[1] - B[1])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2 + abs(C[2] - B[2] + ((A[2] - B[2])*((A[0] - B[0])*(B[0] - D[0]) + (A[1] - B[1])*(B[1] - D[1]) + (A[2] - B[2])*(B[2] - D[2]) - (A[0] - B[0])*(C[0] - D[0]) - (A[1] - B[1])*(C[1] - D[1]) - (A[2] - B[2])*(C[2] - D[2])))/((A[0] - B[0])**2 + (A[1] - B[1])**2 + (A[2] - B[2])**2))**2)**(1/2))
        derivative[9] = 0
        derivative[10] = 0
        derivative[11] = 0

    elif case==8:
        derivative[0] = 0
        derivative[1] = 0
        derivative[2] = 0
        derivative[3] = (abs(B[0] - C[0])*sign(B[0] - C[0]))/(abs(B[0] - C[0])**2 + abs(B[1] - C[1])**2 + abs(B[2] - C[2])**2)**(1/2)
        derivative[4] = (abs(B[1] - C[1])*sign(B[1] - C[1]))/(abs(B[0] - C[0])**2 + abs(B[1] - C[1])**2 + abs(B[2] - C[2])**2)**(1/2)
        derivative[5] = (abs(B[2] - C[2])*sign(B[2] - C[2]))/(abs(B[0] - C[0])**2 + abs(B[1] - C[1])**2 + abs(B[2] - C[2])**2)**(1/2)
        derivative[6] = -(abs(B[0] - C[0])*sign(B[0] - C[0]))/(abs(B[0] - C[0])**2 + abs(B[1] - C[1])**2 + abs(B[2] - C[2])**2)**(1/2)
        derivative[7] = -(abs(B[1] - C[1])*sign(B[1] - C[1]))/(abs(B[0] - C[0])**2 + abs(B[1] - C[1])**2 + abs(B[2] - C[2])**2)**(1/2)
        derivative[8] = -(abs(B[2] - C[2])*sign(B[2] - C[2]))/(abs(B[0] - C[0])**2 + abs(B[1] - C[1])**2 + abs(B[2] - C[2])**2)**(1/2)
        derivative[9] = 0
        derivative[10] = 0
        derivative[11] = 0

    else:
        derivative[0] = (abs(A[0] - C[0])*sign(A[0] - C[0]))/(abs(A[0] - C[0])**2 + abs(A[1] - C[1])**2 + abs(A[2] - C[2])**2)**(1/2)
        derivative[1] = (abs(A[1] - C[1])*sign(A[1] - C[1]))/(abs(A[0] - C[0])**2 + abs(A[1] - C[1])**2 + abs(A[2] - C[2])**2)**(1/2)
        derivative[2] = (abs(A[2] - C[2])*sign(A[2] - C[2]))/(abs(A[0] - C[0])**2 + abs(A[1] - C[1])**2 + abs(A[2] - C[2])**2)**(1/2)
        derivative[3] = 0
        derivative[4] = 0
        derivative[5] = 0
        derivative[6] = -(abs(A[0] - C[0])*sign(A[0] - C[0]))/(abs(A[0] - C[0])**2 + abs(A[1] - C[1])**2 + abs(A[2] - C[2])**2)**(1/2)
        derivative[7] = -(abs(A[1] - C[1])*sign(A[1] - C[1]))/(abs(A[0] - C[0])**2 + abs(A[1] - C[1])**2 + abs(A[2] - C[2])**2)**(1/2)
        derivative[8] = -(abs(A[2] - C[2])*sign(A[2] - C[2]))/(abs(A[0] - C[0])**2 + abs(A[1] - C[1])**2 + abs(A[2] - C[2])**2)**(1/2)
        derivative[9] = 0
        derivative[10] = 0
        derivative[11] = 0

    return derivative
